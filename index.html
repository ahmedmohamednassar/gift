<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Ù…Ø·Ø¹Ù… Ø§Ù„Ù‚Ø§Ø³Ù… Ù„Ù„Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø§Ù„Ø´Ø¹Ø¨ÙŠØ©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            overflow-y: auto;
            min-height: 100vh;
            background: radial-gradient(circle, #ce1212 0%, #1a1a1a 100%);
            color: #fff;
            margin: 0;
            padding: 40px 0; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ø¹Ù„ÙˆÙŠ */
            display: flex;
            align-items: flex-start; /* ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø°Ø§Ø© Ù„ØªØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ */
            justify-content: center;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            border: 2px solid #ce1212;
            color: #1a1a1a;
            width: 100%;
            max-width: 1024px;
        }
        .wheel-container {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto;
            flex-shrink: 0;
        }
        @media (min-height: 800px) {
            .wheel-container { width: 380px; height: 380px; }
        }
        #wheelCanvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 10px solid #1a1a1a;
            transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1);
            box-shadow: 0 0 40px rgba(0,0,0,0.5);
        }
        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid #ce1212;
            z-index: 30;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.3));
        }
        .btn-primary {
            background-color: #ce1212;
            color: white;
            transition: all 0.3s;
        }
        .btn-primary:hover:not(:disabled) { background-color: #a00d0d; transform: scale(1.02); }
        .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; }
        
        #namesList {
            border: 3px solid #f3f4f6;
            background: #ffffff;
            line-height: 1.6;
            min-height: 200px;
        }
        
        /* Modal Style */
        #winnerModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(8px);
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 90%;
            width: 500px;
            border: 5px solid #ce1212;
            animation: popIn 0.5s cubic-bezier(0.17, 0.89, 0.32, 1.49);
        }
        @keyframes popIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .winner-name-animate {
            background: linear-gradient(45deg, #ce1212, #1a1a1a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
        }
    </style>
</head>
<body>

    <!-- Winner Modal -->
    <div id="winnerModal">
        <div class="modal-content relative shadow-2xl">
            <div class="mb-4 flex justify-center">
                <img src="https://i.ibb.co/KzNYHtvM/1003840964-removebg-preview.png" alt="Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù‚Ø§Ø³Ù…" class="h-24 object-contain animate-bounce">
            </div>
            <div class="mb-2">
                <span class="text-4xl">ğŸŠ</span>
            </div>
            <h2 class="text-2xl font-bold text-gray-600 mb-2">Ø§Ù„ÙØ§Ø¦Ø² Ø³Ø¹ÙŠØ¯ Ø§Ù„Ø­Ø¸ Ù‡Ùˆ:</h2>
            <div id="modalWinnerName" class="text-5xl mb-4 winner-name-animate py-2"></div>
            <div id="modalWinnerPlatform" class="text-xl font-bold text-red-600 mb-8"></div>
            <button onclick="closeModal()" class="w-full bg-black text-white py-4 rounded-xl font-black text-xl hover:bg-gray-800 transition transform active:scale-95">
                Ø¥ØºÙ„Ø§Ù‚ ÙˆØ¬Ù…Ø¹ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² ğŸ
            </button>
        </div>
    </div>

    <!-- Main Game Page -->
    <div id="mainPage" class="glass-panel p-6 flex flex-col mx-4 my-4">
        <!-- ØªÙ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‡ÙŠØ¯Ø± Ù‡Ù†Ø§ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¸Ù‡ÙˆØ± -->
        <div class="flex justify-between items-center mb-6 border-b-2 border-red-50 pb-4 flex-wrap gap-4">
            <div class="flex items-center gap-4">
                <img src="https://i.ibb.co/KzNYHtvM/1003840964-removebg-preview.png" alt="Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù‚Ø§Ø³Ù…" class="h-14 w-auto drop-shadow-sm">
                <div>
                    <h1 class="text-2xl font-black text-gray-800 leading-none">Ù„ÙˆØ­Ø© Ø³Ø­Ø¨ Ù…Ø·Ø¹Ù… Ø§Ù„Ù‚Ø§Ø³Ù…</h1>
                    <span class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Al-Qasim Giveaway System</span>
                </div>
            </div>
            <div class="flex flex-col items-end gap-2">
                <div id="platformIndicator" class="bg-red-600 text-white px-5 py-1.5 rounded-full text-xs font-black shadow-md">
                    ÙÙŠØ³Ø¨ÙˆÙƒ ğŸ”µ
                </div>
                <div class="flex gap-1.5 mt-1 flex-wrap justify-end">
                    <button onclick="setPlatform('ÙÙŠØ³Ø¨ÙˆÙƒ', 'ğŸ”µ')" class="px-3 py-1.5 rounded-lg bg-blue-50 text-blue-700 text-[10px] font-black hover:bg-blue-100 transition shadow-sm border border-blue-100">ÙÙŠØ³Ø¨ÙˆÙƒ</button>
                    <button onclick="setPlatform('Ø¥Ù†Ø³ØªØ¬Ø±Ø§Ù…', 'ğŸŸ£')" class="px-3 py-1.5 rounded-lg bg-purple-50 text-purple-700 text-[10px] font-black hover:bg-purple-100 transition shadow-sm border border-purple-100">Ø¥Ù†Ø³ØªØ¬Ø±Ø§Ù…</button>
                    <button onclick="setPlatform('Ø³Ù†Ø§Ø¨ Ø´Ø§Øª', 'ğŸŸ¡')" class="px-3 py-1.5 rounded-lg bg-yellow-50 text-yellow-700 text-[10px] font-black hover:bg-yellow-100 transition shadow-sm border border-yellow-100">Ø³Ù†Ø§Ø¨</button>
                    <button onclick="setPlatform('Ø¥ÙƒØ³ (X)', 'âš«')" class="px-3 py-1.5 rounded-lg bg-gray-100 text-gray-700 text-[10px] font-black hover:bg-gray-200 transition shadow-sm border border-gray-200">Ø¥ÙƒØ³ X</button>
                </div>
            </div>
        </div>

        <div class="flex flex-col gap-8">
            <div class="flex flex-col items-center justify-center bg-gray-50 rounded-3xl p-8 border border-gray-100 shadow-inner relative overflow-visible">
                <div class="wheel-container">
                    <div class="pointer"></div>
                    <canvas id="wheelCanvas" width="800" height="800"></canvas>
                </div>
                <div class="mt-8 text-center z-10 w-full flex justify-center">
                    <button id="spinBtn" onclick="spinWheel()" class="btn-primary text-2xl font-black py-4 px-12 rounded-2xl shadow-2xl transform active:scale-90 transition-all flex items-center gap-3">
                        <img src="https://i.ibb.co/KzNYHtvM/1003840964-removebg-preview.png" alt="Ù„ÙˆØ¬Ùˆ" class="h-8 brightness-0 invert">
                        <span>Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù‚Ø±Ø¹Ø©</span>
                    </button>
                </div>
            </div>

            <div class="bg-white border-4 border-red-50 rounded-3xl p-6 shadow-xl flex flex-col">
                <div class="flex justify-between items-center mb-4 px-2">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-red-600 rounded-xl flex items-center justify-center shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                            </svg>
                        </div>
                        <div>
                            <span class="text-md font-black text-gray-800 block">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠØ©</span>
                            <span class="text-[10px] text-gray-400 font-bold uppercase">Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„ÙØ§Ø¦Ø² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</span>
                        </div>
                    </div>
                    <div class="flex flex-col items-end">
                        <span class="text-xs font-bold text-gray-400 mb-1">Ø§Ù„Ø¹Ø¯Ø¯</span>
                        <span class="text-xl font-black bg-black text-white px-4 py-1 rounded-xl shadow-lg"><span id="countDisplay">0</span></span>
                    </div>
                </div>
                <textarea id="namesList" class="w-full p-5 text-lg font-bold resize-none outline-none border rounded-2xl transition-all placeholder:text-gray-300" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ù‡Ù†Ø§..."></textarea>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        let currentPlatform = 'ÙÙŠØ³Ø¨ÙˆÙƒ';
        let platformEmoji = 'ğŸ”µ';
        
        const colors = ['#ce1212', '#ffffff', '#1a1a1a'];

        function setPlatform(p, emoji) {
            currentPlatform = p;
            platformEmoji = emoji;
            document.getElementById('platformIndicator').innerText = `${p} ${emoji}`;
        }

        function drawWheel() {
            const names = document.getElementById('namesList').value.split('\n').filter(n => n.trim() !== "");
            const count = names.length;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (count === 0) {
                ctx.beginPath(); ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                ctx.fillStyle = '#ce1212'; ctx.fill();
                ctx.fillStyle = 'white'; ctx.font = 'bold 40px Tajawal'; ctx.textAlign = 'center';
                ctx.fillText('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ù„Ù„Ø¨Ø¯Ø¡', centerX, centerY);
                return;
            }

            const arcSize = (2 * Math.PI) / count;
            names.forEach((name, i) => {
                const angle = i * arcSize;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + arcSize);
                
                ctx.fillStyle = colors[i % 3];
                ctx.fill();
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.stroke();

                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + arcSize / 2);
                ctx.textAlign = "right";
                
                const bgColor = colors[i % 3];
                ctx.fillStyle = (bgColor === '#ffffff') ? '#ce1212' : '#ffffff';
                
                let fontSize = count > 20 ? 22 : (count > 10 ? 30 : 42);
                ctx.font = `900 ${fontSize}px Tajawal`;
                ctx.fillText(name, radius - 40, 10);
                ctx.restore();
            });
        }

        function updateCount() {
            const text = document.getElementById('namesList').value;
            const names = text.split('\n').filter(n => n.trim() !== "");
            document.getElementById('countDisplay').innerText = names.length;
            drawWheel();
        }

        document.getElementById('namesList').addEventListener('input', updateCount);

        let isSpinning = false;

        function spinWheel() {
            if (isSpinning) return;
            let names = document.getElementById('namesList').value.split('\n').filter(n => n.trim() !== "");
            
            if (names.length < 2) {
                alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù…ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø³Ø­Ø¨!");
                return;
            }

            isSpinning = true;
            const wheel = document.getElementById('wheelCanvas');
            const spinBtn = document.getElementById('spinBtn');

            spinBtn.disabled = true;
            spinBtn.querySelector('span').innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø³Ø­Ø¨...";

            const extraDeg = Math.floor(Math.random() * 360);
            const totalDeg = 3600 + extraDeg; 
            
            wheel.style.transform = `rotate(${totalDeg}deg)`;

            setTimeout(() => {
                isSpinning = false;
                spinBtn.disabled = false;
                spinBtn.querySelector('span').innerText = "Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù‚Ø±Ø¹Ø©";
                
                const actualDeg = extraDeg % 360;
                const index = Math.floor(((360 - actualDeg + 270) % 360) / (360 / names.length));
                const winnerIdx = index % names.length;
                const winner = names[winnerIdx];

                showWinnerModal(winner);
                
                const duration = 3 * 1000;
                const animationEnd = Date.now() + duration;
                const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 200 };

                const randomInRange = (min, max) => Math.random() * (max - min) + min;

                const interval = setInterval(function() {
                    const timeLeft = animationEnd - Date.now();
                    if (timeLeft <= 0) return clearInterval(interval);
                    const particleCount = 50 * (timeLeft / duration);
                    confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } });
                    confetti({ ...defaults, particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } });
                }, 250);

                const updatedNames = names.filter((n, idx) => idx !== winnerIdx);
                document.getElementById('namesList').value = updatedNames.join('\n');
                updateCount();
                
                wheel.style.transition = 'none';
                wheel.style.transform = `rotate(${extraDeg}deg)`;
                setTimeout(() => { wheel.style.transition = 'transform 4s cubic-bezier(0.15, 0, 0.15, 1)'; }, 50);

            }, 4000);
        }

        function showWinnerModal(name) {
            document.getElementById('modalWinnerName').innerText = name;
            document.getElementById('modalWinnerPlatform').innerText = `${platformEmoji} ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¹Ø¨Ø± ${currentPlatform}`;
            document.getElementById('winnerModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('winnerModal').style.display = 'none';
        }

        window.onload = drawWheel;
    </script>
</body>
</html>

